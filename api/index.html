
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A machine learning toolkit for astronomical data analysis using XGBoost">
      
      
        <meta name="author" content="Kurt Hamblin">
      
      
        <link rel="canonical" href="https://hamblin-ku.github.io/AGNBoost/api/">
      
      
        <link rel="prev" href="../tutorials/tuning%2Btraining/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>API Reference - AGNBoost</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AGNBoost" class="md-header__button md-logo" aria-label="AGNBoost" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AGNBoost
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/hamblin-ku/AGNBoost" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tutorials/basic-usage/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AGNBoost" class="md-nav__button md-logo" aria-label="AGNBoost" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AGNBoost
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hamblin-ku/AGNBoost" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/basic-usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AGNBoost Basic Usage Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/CustomFeatures%2BTargets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Features and Transformed Target Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/custom_bands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using AGNBoost with Custom (non-default) Photometric Bands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/tuning%2Btraining/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training and Tuning AGNBoost Models from Scratch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#catalog-class" class="md-nav__link">
    <span class="md-ellipsis">
      Catalog Class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Catalog Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.create_color_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_color_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.remove_negative_fluxes" class="md-nav__link">
    <span class="md-ellipsis">
      remove_negative_fluxes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_features_from_phots" class="md-nav__link">
    <span class="md-ellipsis">
      get_features_from_phots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.create_feature_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_feature_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_targets" class="md-nav__link">
    <span class="md-ellipsis">
      get_targets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_features" class="md-nav__link">
    <span class="md-ellipsis">
      get_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_feature_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_feature_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_length" class="md-nav__link">
    <span class="md-ellipsis">
      get_length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.print_data_summary" class="md-nav__link">
    <span class="md-ellipsis">
      print_data_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_valid_bands" class="md-nav__link">
    <span class="md-ellipsis">
      get_valid_bands
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_valid_bands_list" class="md-nav__link">
    <span class="md-ellipsis">
      get_valid_bands_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_band_wavelengths" class="md-nav__link">
    <span class="md-ellipsis">
      get_band_wavelengths
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_band_shorthands" class="md-nav__link">
    <span class="md-ellipsis">
      get_band_shorthands
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.sn_cut" class="md-nav__link">
    <span class="md-ellipsis">
      sn_cut
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_columns" class="md-nav__link">
    <span class="md-ellipsis">
      get_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_subset" class="md-nav__link">
    <span class="md-ellipsis">
      get_subset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.save_to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      save_to_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.drop_nan" class="md-nav__link">
    <span class="md-ellipsis">
      drop_nan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.split_data" class="md-nav__link">
    <span class="md-ellipsis">
      split_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_split_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_split_df
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agnboost-class" class="md-nav__link">
    <span class="md-ellipsis">
      AGNBoost Class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AGNBoost Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-features_1" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.get_models" class="md-nav__link">
    <span class="md-ellipsis">
      get_models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.tune_model" class="md-nav__link">
    <span class="md-ellipsis">
      tune_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.retrieve_dist" class="md-nav__link">
    <span class="md-ellipsis">
      retrieve_dist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.custom_objective" class="md-nav__link">
    <span class="md-ellipsis">
      custom_objective
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.custom_tune_function" class="md-nav__link">
    <span class="md-ellipsis">
      custom_tune_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.plot_eval" class="md-nav__link">
    <span class="md-ellipsis">
      plot_eval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.train_model" class="md-nav__link">
    <span class="md-ellipsis">
      train_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.get_available_files" class="md-nav__link">
    <span class="md-ellipsis">
      get_available_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.get_available_models" class="md-nav__link">
    <span class="md-ellipsis">
      get_available_models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.load_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.dmatrix_validate" class="md-nav__link">
    <span class="md-ellipsis">
      dmatrix_validate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.prediction_uncertainty" class="md-nav__link">
    <span class="md-ellipsis">
      prediction_uncertainty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.model_uncertainty" class="md-nav__link">
    <span class="md-ellipsis">
      model_uncertainty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.uncertainty_phot" class="md-nav__link">
    <span class="md-ellipsis">
      uncertainty_phot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utility-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Utility Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utility Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.log_message" class="md-nav__link">
    <span class="md-ellipsis">
      log_message
    </span>
  </a>
  
    <nav class="md-nav" aria-label="log_message">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.log_message--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_grid" class="md-nav__link">
    <span class="md-ellipsis">
      validate_param_grid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validate_param_grid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_grid--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_grid--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_dict" class="md-nav__link">
    <span class="md-ellipsis">
      validate_param_dict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validate_param_dict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_dict--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_dict--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#catalog-class" class="md-nav__link">
    <span class="md-ellipsis">
      Catalog Class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Catalog Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.create_color_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_color_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.remove_negative_fluxes" class="md-nav__link">
    <span class="md-ellipsis">
      remove_negative_fluxes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_features_from_phots" class="md-nav__link">
    <span class="md-ellipsis">
      get_features_from_phots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.create_feature_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_feature_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_targets" class="md-nav__link">
    <span class="md-ellipsis">
      get_targets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_features" class="md-nav__link">
    <span class="md-ellipsis">
      get_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_feature_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_feature_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_length" class="md-nav__link">
    <span class="md-ellipsis">
      get_length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.print_data_summary" class="md-nav__link">
    <span class="md-ellipsis">
      print_data_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_valid_bands" class="md-nav__link">
    <span class="md-ellipsis">
      get_valid_bands
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_valid_bands_list" class="md-nav__link">
    <span class="md-ellipsis">
      get_valid_bands_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_band_wavelengths" class="md-nav__link">
    <span class="md-ellipsis">
      get_band_wavelengths
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_band_shorthands" class="md-nav__link">
    <span class="md-ellipsis">
      get_band_shorthands
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.sn_cut" class="md-nav__link">
    <span class="md-ellipsis">
      sn_cut
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_columns" class="md-nav__link">
    <span class="md-ellipsis">
      get_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_subset" class="md-nav__link">
    <span class="md-ellipsis">
      get_subset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.save_to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      save_to_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.drop_nan" class="md-nav__link">
    <span class="md-ellipsis">
      drop_nan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.split_data" class="md-nav__link">
    <span class="md-ellipsis">
      split_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.dataset.Catalog.get_split_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_split_df
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agnboost-class" class="md-nav__link">
    <span class="md-ellipsis">
      AGNBoost Class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AGNBoost Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-features_1" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.get_models" class="md-nav__link">
    <span class="md-ellipsis">
      get_models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.tune_model" class="md-nav__link">
    <span class="md-ellipsis">
      tune_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.retrieve_dist" class="md-nav__link">
    <span class="md-ellipsis">
      retrieve_dist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.custom_objective" class="md-nav__link">
    <span class="md-ellipsis">
      custom_objective
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.custom_tune_function" class="md-nav__link">
    <span class="md-ellipsis">
      custom_tune_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.plot_eval" class="md-nav__link">
    <span class="md-ellipsis">
      plot_eval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.train_model" class="md-nav__link">
    <span class="md-ellipsis">
      train_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.get_available_files" class="md-nav__link">
    <span class="md-ellipsis">
      get_available_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.get_available_models" class="md-nav__link">
    <span class="md-ellipsis">
      get_available_models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.load_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.dmatrix_validate" class="md-nav__link">
    <span class="md-ellipsis">
      dmatrix_validate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.prediction_uncertainty" class="md-nav__link">
    <span class="md-ellipsis">
      prediction_uncertainty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.model_uncertainty" class="md-nav__link">
    <span class="md-ellipsis">
      model_uncertainty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.model.AGNBoost.uncertainty_phot" class="md-nav__link">
    <span class="md-ellipsis">
      uncertainty_phot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utility-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Utility Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utility Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.log_message" class="md-nav__link">
    <span class="md-ellipsis">
      log_message
    </span>
  </a>
  
    <nav class="md-nav" aria-label="log_message">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.log_message--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_grid" class="md-nav__link">
    <span class="md-ellipsis">
      validate_param_grid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validate_param_grid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_grid--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_grid--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_dict" class="md-nav__link">
    <span class="md-ellipsis">
      validate_param_dict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validate_param_dict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_dict--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agnboost.utils.validate_param_dict--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  
    
      
    
    <a href="https://github.com/hamblin-ku/AGNBoost/raw/master/docs/api.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<p>This page provides complete documentation for all AGNBoost classes and functions.</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>AGNBoost consists of two main classes:</p>
<ul>
<li><strong>Catalog</strong>: For data loading, management, and feature engineering</li>
<li><strong>AGNBoost</strong>: For machine learning model training, tuning, and prediction</li>
</ul>
<hr />
<h2 id="catalog-class">Catalog Class<a class="headerlink" href="#catalog-class" title="Permanent link">&para;</a></h2>
<p>The <code>Catalog</code> class is your entry point for working with astronomical data. It handles loading data from various formats, validates photometric bands, creates features, and manages data splits.</p>
<h3 id="key-features">Key Features<a class="headerlink" href="#key-features" title="Permanent link">&para;</a></h3>
<ul>
<li>Load FITS files, CSV files, or pandas DataFrames</li>
<li>Automatic photometric band validation</li>
<li>Feature engineering (colors, transformations)</li>
<li>Train/validation/test data splitting</li>
<li>Signal-to-noise filtering</li>
</ul>


<div class="doc doc-object doc-class">




    <div class="doc doc-contents first">


        <p>A class for loading, managing, and manipulating astronomical data.</p>
<p>The Catalog class provides tools for loading astronomical data from various formats,
performing feature engineering, data validation, and preparing data for machine learning
workflows. It supports FITS files, CSV files, and pandas DataFrames.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.dataset.Catalog.data">data</span></code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The main astronomical dataset.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.dataset.Catalog.features_df">features_df</span></code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Engineered features for machine learning.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.dataset.Catalog.allowed_bands">allowed_bands</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary storing the information (column name in data, shorthand name, and wavelength) for the used photometric bands</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.dataset.Catalog.valid_columns">valid_columns</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary storing the the photometric bands from allowed_bands that are found in the stored data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.dataset.Catalog.train_indices">train_indices</span></code></td>
            <td>
                  <code><span title="pandas.Index">Index</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indices for training data split.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.dataset.Catalog.val_indices">val_indices</span></code></td>
            <td>
                  <code><span title="pandas.Index">Index</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indices for validation data split.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.dataset.Catalog.trainval_indices">trainval_indices</span></code></td>
            <td>
                  <code><span title="pandas.Index">Index</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indices for combined training + validation data split.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.dataset.Catalog.test_indices">test_indices</span></code></td>
            <td>
                  <code><span title="pandas.Index">Index</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indices for test data split.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.dataset.Catalog.custom_feature_func">custom_feature_func</span></code></td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>User created function to create custom features.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic usage with a FITS file:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agnboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">Catalog</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># Load data</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">catalog</span> <span class="o">=</span> <span class="n">Catalog</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;jwst_data.fits&quot;</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># Create features</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">catalog</span><span class="o">.</span><span class="n">create_feature_dataframe</span><span class="p">()</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1"># Split data</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">catalog</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">val_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</span></code></pre></div>
<p>Loading data from a pandas DataFrame:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data.csv&quot;</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">catalog</span> <span class="o">=</span> <span class="n">Catalog</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</span></code></pre></div>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.create_color_dataframe" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_color_dataframe</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#agnboost.dataset.Catalog.create_color_dataframe" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">create_color_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bands</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate photometric colors from band flux measurements.</p>
<p>Creates all possible non-reciprocal photometric colors from the provided band data.
Colors are calculated as log10(flux_i / flux_j) where band_i has a longer wavelength
than band_j. This follows standard astronomical convention where colors like (J-H) 
represent log10(flux_J / flux_H).</p>
<p>The bands are automatically sorted by wavelength in descending order (longest to 
shortest wavelength) to ensure consistent color naming and calculation. For example,
with bands at 2.2μm, 1.6μm, and 1.2μm, this will create colors like:
- 2.2μm/1.6μm (longer/shorter)
- 2.2μm/1.2μm 
- 1.6μm/1.2μm</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing flux measurements for each object.
Must have columns corresponding to the band names in the <code>bands</code> dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bands</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping band column names to their metadata. Each band
entry must contain 'wavelength' and 'shorthand' keys. Example:
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>{
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    &#39;jwst.nircam.F200W&#39;: {&#39;wavelength&#39;: 1.988, &#39;shorthand&#39;: &#39;F200W&#39;},
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    &#39;jwst.nircam.F150W&#39;: {&#39;wavelength&#39;: 1.501, &#39;shorthand&#39;: &#39;F150W&#39;}
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>}
</span></code></pre></div></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame or None: DataFrame containing computed color columns with the same
index as the input data. Column names follow the format "shorthand_i/shorthand_j"
where shorthand_i corresponds to the longer wavelength band. Returns None if
fewer than 2 bands are provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a band name in the <code>bands</code> dictionary is not found as a column in <code>data</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If flux values are zero or negative (causing log10 calculation errors).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic color calculation:</p>
<p>Using with a Catalog instance:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agnboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">Catalog</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">catalog</span> <span class="o">=</span> <span class="n">Catalog</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;jwst_data.fits&quot;</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">valid_bands</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get_valid_bands</span><span class="p">()</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">colors</span> <span class="o">=</span> <span class="n">Catalog</span><span class="o">.</span><span class="n">create_color_dataframe</span><span class="p">(</span><span class="n">catalog</span><span class="o">.</span><span class="n">get_data</span><span class="p">(),</span> <span class="n">valid_bands</span><span class="p">)</span>
</span></code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Colors are calculated as log10(longer_wavelength_flux / shorter_wavelength_flux)</li>
<li>Zero or negative flux values will produce NaN or infinite values in the colors</li>
<li>The method creates n*(n-1)/2 colors for n input bands</li>
<li>Band sorting by wavelength ensures consistent color naming across different datasets</li>
<li>Color names use shorthand identifiers for readability (e.g., 'F200W/F150W' vs full names)</li>
</ul>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>create_feature_dataframe: Higher-level method that includes color creation
transform: For applying custom transformations to individual columns</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.remove_negative_fluxes" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">remove_negative_fluxes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#agnboost.dataset.Catalog.remove_negative_fluxes" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">remove_negative_fluxes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bands</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Remove negative and zero flux values by replacing them with NaN.</p>
<p>Negative or zero flux measurements are often unphysical in astronomical data and
can cause issues with logarithmic calculations (magnitudes, colors). This method
identifies such values in photometric band columns and replaces them with NaN
to prevent downstream calculation errors while preserving the data structure.</p>
<p>This is particularly important for:
- Magnitude calculations: mag = -2.5 * log10(flux)
- Color calculations: color = log10(flux1 / flux2) 
- Feature transforamtions that use logarithmic transformations</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing astronomical measurements.
Must include columns corresponding to the band names specified in <code>bands</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bands</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping band column names to their metadata. Only
the keys (band column names) are used for processing. Example:
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>{
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    &#39;jwst.nircam.F200W&#39;: {&#39;wavelength&#39;: 1.988, &#39;shorthand&#39;: &#39;F200W&#39;},
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    &#39;jwst.nircam.F150W&#39;: {&#39;wavelength&#39;: 1.501, &#39;shorthand&#39;: &#39;F150W&#39;}
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>}
</span></code></pre></div></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame or None: Copy of the input DataFrame with negative and zero
flux values replaced by NaN in the specified band columns. Other columns
remain unchanged. Returns None if an error occurs during processing.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a band column name is not found in the DataFrame columns.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For any other processing errors (logged and returns None).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Clean flux measurements before magnitude calculation:</p>
<p>Use with a Catalog instance:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agnboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">Catalog</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">catalog</span> <span class="o">=</span> <span class="n">Catalog</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;survey_data.fits&quot;</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">valid_bands</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get_valid_bands</span><span class="p">()</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">clean_data</span> <span class="o">=</span> <span class="n">Catalog</span><span class="o">.</span><span class="n">remove_negative_fluxes</span><span class="p">(</span><span class="n">catalog</span><span class="o">.</span><span class="n">get_data</span><span class="p">(),</span> <span class="n">valid_bands</span><span class="p">)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1"># Now safe to calculate magnitudes and colors</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">magnitudes</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">clean_data</span><span class="p">[</span><span class="n">band_columns</span><span class="p">])</span>
</span></code></pre></div>
<p>Integration with feature engineering:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Clean data before creating features</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">catalog</span> <span class="o">=</span> <span class="n">Catalog</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;photometry.fits&quot;</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">bands</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get_valid_bands</span><span class="p">()</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c1"># Remove problematic values</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">clean_data</span> <span class="o">=</span> <span class="n">Catalog</span><span class="o">.</span><span class="n">remove_negative_fluxes</span><span class="p">(</span><span class="n">catalog</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">bands</span><span class="p">)</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">catalog</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">clean_data</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c1"># Now create features safely</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="n">catalog</span><span class="o">.</span><span class="n">create_feature_dataframe</span><span class="p">()</span>
</span></code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Automatically called by the dop_nan() Catalog class method</li>
<li>Only modifies columns specified in the <code>bands</code> dictionary</li>
<li>Non-band columns (IDs, coordinates, etc.) are left unchanged</li>
<li>Creates a copy of the input data, preserving the original</li>
<li>Zero flux values are also replaced as they cause issues with log calculations</li>
<li>NaN values can be handled by downstream methods like <code>drop_nan()</code></li>
<li>The method logs warnings for each column where negative values are found</li>
</ul>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>drop_nan: Remove rows with NaN values after cleaning
create_feature_dataframe: Higher-level method that may use cleaned data
sn_cut: Alternative approach using signal-to-noise thresholds</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_features_from_phots" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_features_from_phots</span>


<a href="#agnboost.dataset.Catalog.get_features_from_phots" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_features_from_phots</span><span class="p">(</span><span class="n">phot_df</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate the feature data frame for a single row (i.e., a single source) of data.</p>
<p>Uses either the default feature creation, or if a custom feature function has previously
been used to create features, it will call that.</p>
<p>By default, the created features will include:
1. <strong>Log photometry</strong>: log10(flux) for each band 
2. <strong>Colors</strong>: log10(flux_i / flux_j) for all band pairs 
3. <strong>Squared colors</strong>: (color)² terms</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>phot_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing photometric flux measurements.
Must have columns corresponding to the valid photometric bands found during
catalog initialization. Typically this would be a subset of the main catalog
data containing only the validated band columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: DataFrame containing engineered features with the same index
as the input photometric data. Feature columns include:</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If photometric DataFrame contains non-positive values that prevent
log calculations.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If custom_feature_func is not callable when provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If required band columns are missing from the photometric DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Default feature engineering with JWST bands:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agnboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">Catalog</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># Load catalog with JWST data</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">catalog</span> <span class="o">=</span> <span class="n">Catalog</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;jwst_photometry.fits&quot;</span><span class="p">)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># Get photometric data for valid bands only</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">valid_bands</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get_valid_bands</span><span class="p">()</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">phot_data</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="nb">list</span><span class="p">(</span><span class="n">valid_bands</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c1"># Generate features</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">features</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get_features_from_phots</span><span class="p">(</span><span class="n">phot_data</span><span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created </span><span class="si">{</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> features from </span><span class="si">{</span><span class="n">phot_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> bands&quot;</span><span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># Example output columns:</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="c1"># [&#39;jwst.nircam.F115W&#39;, &#39;jwst.nircam.F150W&#39;, &#39;jwst.nircam.F200W&#39;,  # log phot</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1">#  &#39;F200W/F150W&#39;, &#39;F200W/F115W&#39;, &#39;F150W/F115W&#39;,                    # colors  </span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1">#  &#39;F200W/F150W^2&#39;, &#39;F200W/F115W^2&#39;, &#39;F150W/F115W^2&#39;]             # squared colors</span>
</span></code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li><strong>Data cleaning</strong>: Ensure input data doesn't contain negative or zero flux values
  before calling this method, as log calculations will fail</li>
<li><strong>Custom functions</strong>: If using custom_feature_func, ensure it has only a (data)
  non-default parameter and returns a DataFrame with the same index</li>
<li><strong>NaN handling</strong>: Any NaN values in input photometry will propagate through
  the feature calculations</li>
</ul>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>create_feature_dataframe: Higher-level method that handles the complete pipeline
create_color_dataframe: Standalone color calculation method
remove_negative_fluxes: Data cleaning for problematic flux values</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.create_feature_dataframe" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_feature_dataframe</span>


<a href="#agnboost.dataset.Catalog.create_feature_dataframe" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">create_feature_dataframe</span><span class="p">(</span><span class="n">custom_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Create feature dataframe to use with AGNBoost.</p>
<p>Uses either the default feature creation, or if a custom feature function is provided,
that function will be used for feature creation.</p>
<p>By default, the created features will include:
1. <strong>Log photometry</strong>: log10(flux) for each band 
2. <strong>Colors</strong>: log10(flux_i / flux_j) for all band pairs 
3. <strong>Squared colors</strong>: (color)² terms</p>
<p>The resulting feature dataframe is stored as <code>self.features_df</code> and can be used
directly with AGNBoost models for training and prediction. If a custom feature function
is provided, it will saved into self.custom_func</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>custom_func</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom function to generate features from the data.
Must accept the catalog's data as input and return a pandas DataFrame with the
same index as the original data. If None, uses the default feature pipeline.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>silent</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, suppresses logging output about feature creation.
Useful for batch processing or when called repeatedly. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame or None: DataFrame containing engineered features with the same
index as the catalog data. Also stored as <code>self.features_df</code>. Returns None
if feature creation fails or if no valid data/columns are available.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>custom_func</code> is provided but is not callable, or if custom function
doesn't return a pandas DataFrame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If custom function returns DataFrame with different length than catalog data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If custom function returns DataFrame with mismatched index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Default feature engineering:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agnboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">Catalog</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># Load astronomical data</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">catalog</span> <span class="o">=</span> <span class="n">Catalog</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;jwst_observations.fits&quot;</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># Create default features</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">features</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">create_feature_dataframe</span><span class="p">()</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created </span><span class="si">{</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> features for </span><span class="si">{</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> objects&quot;</span><span class="p">)</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># Features are automatically stored</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="k">assert</span> <span class="n">catalog</span><span class="o">.</span><span class="n">features_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature columns:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">catalog</span><span class="o">.</span><span class="n">features_df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</span></code></pre></div>
<p>Using with custom feature function:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">polynomial_features</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create polynomial features from photometric data.&quot;&quot;&quot;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="c1"># Get valid bands (this would be passed from catalog context)</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="n">feature_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="c1"># Example: create polynomial features for first few bands</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="n">band_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;jwst&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">band_cols</span><span class="p">:</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>        <span class="k">if</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>            <span class="c1"># Linear, quadratic, and cubic terms</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>            <span class="n">feature_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">band</span><span class="si">}</span><span class="s2">_log&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">])</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>            <span class="n">feature_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">band</span><span class="si">}</span><span class="s2">_log2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>            <span class="n">feature_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">band</span><span class="si">}</span><span class="s2">_log3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">band</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    <span class="k">return</span> <span class="n">feature_df</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="c1"># Use custom function</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="n">catalog</span> <span class="o">=</span> <span class="n">Catalog</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;survey_data.fits&quot;</span><span class="p">)</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="n">custom_features</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">create_feature_dataframe</span><span class="p">(</span><span class="n">custom_func</span><span class="o">=</span><span class="n">polynomial_features</span><span class="p">)</span>
</span></code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li><strong>Data validation</strong>: Requires valid photometric bands identified during catalog initialization</li>
<li><strong>Index preservation</strong>: All feature operations maintain the original data index</li>
<li><strong>Memory usage</strong>: Default pipeline roughly triples the feature count (bands + colors + squared colors)</li>
<li><strong>NaN handling</strong>: Method reports NaN counts but doesn't remove them (use <code>drop_nan()</code> if needed)</li>
<li><strong>Custom functions</strong>: Must return DataFrame with identical index to original data</li>
<li><strong>Storage</strong>: Result is automatically stored as <code>self.features_df</code> for later use</li>
<li><strong>Error recovery</strong>: Returns None on failure while logging specific error details</li>
</ul>
</details>

<details class="default-feature-set" open>
  <summary>Default Feature Set</summary>
  <p>For n photometric bands, creates approximately:<br />
- <strong>n log-photometry features</strong>: One per validated band
- <strong>n(n-1)/2 color features</strong>: All unique band pair combinations<br />
- <strong>n(n-1)/2 squared color features</strong>: Squared versions of colors
- <strong>Total</strong>: n + n(n-1) ≈ n² features for large n</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>get_features: Retrieve stored features (creates them if needed)
remove_negative_fluxes: Clean data before feature creation
split_data: Create train/validation/test splits of features
get_features_from_phots: Lower-level feature creation from photometry subset</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">transform</span>


<a href="#agnboost.dataset.Catalog.transform" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">transform</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">transform_func</span><span class="p">,</span> <span class="n">new_column_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Apply a transformation function to a column and save the result.</p>
<p>This method provides a flexible way to transform data in a specified column
using any callable function. The transformation can either replace the 
original column (inplace=True) or create a new column with the transformed data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>column_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column to transform. Must exist in the 
loaded dataset. The column can contain any data type that the
transformation function can handle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transform_func</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply to the column. Should accept 
a pandas.Series as input and return a pandas.Series, array-like object, 
or scalar values. Examples:
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>lambda x: x * 2              # Mathematical scaling
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>np.log                       # Logarithmic transformation
</span></code></pre></div></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_column_name</code>
            </td>
            <td>
                  <code>str or None, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name for the transformed 
column. If None and not inplace, will automatically generate a name
using f"{column_name}<em function_name="function_name">transformed" or f"{column_name}</em>" 
if the function has a recognizable <strong>name</strong> attribute.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inplace</code>
            </td>
            <td>
                  <code>bool, default=False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite the original column 
with transformed data. If False, create a new column with the 
transformed data, preserving the original column.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.Series or None: The transformed column as a pandas.Series if 
successful, with proper indexing matching the original DataFrame.
Returns None if transformation fails due to errors, invalid inputs,
or missing data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the specified column_name is not found in the DataFrame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If transform_func is not callable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For any transformation execution errors (logged and returns None).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Examples:</p>
<div class="language-text highlight"><pre><span></span><code>Photometry logarithmic transformation:

```python
# Apply log10 transformation directly to the column
import numpy as np
catalog.transform(&#39;phot_col&#39;, np.log10)
```
</code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The method automatically handles conversion of transformation results to pandas.Series</li>
<li>Validates all input parameters before attempting transformation</li>
<li>Maintains original DataFrame index in the transformed data</li>
<li>Function names are automatically detected for column naming when possible</li>
</ul>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_targets" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_targets</span>


<a href="#agnboost.dataset.Catalog.get_targets" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_targets</span><span class="p">(</span><span class="n">target_names</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Extract target columns from the data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target_names</code>
            </td>
            <td>
                  <code> (str or list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name(s) of target column(s) to extract.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_na</code>
            </td>
            <td>
                  <code> (bool, default=False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, drop rows with NA values in any of the target columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame or pandas.Series:
Target column(s). Returns a Series if a single target name is provided,
or a DataFrame if multiple targets are requested.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_features" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_features</span>


<a href="#agnboost.dataset.Catalog.get_features" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_features</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the feature dataframe, creating it if it doesn't exist.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: The feature dataframe.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_feature_names" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_feature_names</span>


<a href="#agnboost.dataset.Catalog.get_feature_names" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_feature_names</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the feature names dataframe, creating it if it doesn't exist.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: The names of the feature dataframe columns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_length" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_length</span>


<a href="#agnboost.dataset.Catalog.get_length" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_length</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the length saved data from the Catalog instance.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int or None: The length of the saved data, or else None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.print_data_summary" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">print_data_summary</span>


<a href="#agnboost.dataset.Catalog.print_data_summary" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">print_data_summary</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Print a formatted summary of the loaded data.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_valid_bands" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_valid_bands</span>


<a href="#agnboost.dataset.Catalog.get_valid_bands" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_valid_bands</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get information about valid band columns in the data.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of valid band columns with their metadata.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_valid_bands_list" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_valid_bands_list</span>


<a href="#agnboost.dataset.Catalog.get_valid_bands_list" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_valid_bands_list</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get information about valid band columns in the data.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of valid band columns with their metadata.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_band_wavelengths" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_band_wavelengths</span>


<a href="#agnboost.dataset.Catalog.get_band_wavelengths" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_band_wavelengths</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a dictionary mapping band columns to their wavelengths.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping column names to wavelengths in microns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_band_shorthands" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_band_shorthands</span>


<a href="#agnboost.dataset.Catalog.get_band_shorthands" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_band_shorthands</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a dictionary mapping band columns to their shorthand names.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping column names to shorthand identifiers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.sn_cut" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sn_cut</span>


<a href="#agnboost.dataset.Catalog.sn_cut" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">sn_cut</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;_err&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Perform a signal-to-noise ratio cut on the specified columns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping value columns to their error columns.
Example: 
    <div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>{
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>&#39;jwst.miri.F770W&#39;: &#39;jwst.miri.F770W_err&#39;,
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>&#39;jwst.miri.F1500W&#39;: &#39;jwst.miri.F1500W_err&#39;
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>}
</span></code></pre></div>
If None, automatically detect band columns and use {band: band+suffix} pairs.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threshold</code>
            </td>
            <td>
                  <code>float, default=3.0</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum S/N ratio to keep a row.</p>
              </div>
            </td>
            <td>
                  <code>3.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inplace</code>
            </td>
            <td>
                  <code>bool, default=False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, modifies the data in place; otherwise, returns a copy.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suffix</code>
            </td>
            <td>
                  <code>str, default=&#39;_err&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Suffix to append to band names to find error columns, if columns=None.</p>
              </div>
            </td>
            <td>
                  <code>&#39;_err&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame or None: Filtered dataframe if inplace=False, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_data" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_data</span>


<a href="#agnboost.dataset.Catalog.get_data" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_data</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the loaded dataframe.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: The loaded data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_columns" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_columns</span>


<a href="#agnboost.dataset.Catalog.get_columns" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_columns</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the column names of the loaded dataframe.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_subset" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_subset</span>


<a href="#agnboost.dataset.Catalog.get_subset" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_subset</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a subset of the data by columns and/or rows.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code>list, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names to include. If None, includes all columns.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rows</code>
            </td>
            <td>
                  <code>slice, list, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rows to include. 
Can be a slice (e.g., slice(0, 100)), a list of indices,or None to include all rows.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame or None: Subset of the data, or None if no data to load.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.save_to_csv" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_to_csv</span>


<a href="#agnboost.dataset.Catalog.save_to_csv" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_to_csv</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the current data to a CSV file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the CSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>bool, default=False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include the index in the saved file.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if successful, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.drop_nan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">drop_nan</span>


<a href="#agnboost.dataset.Catalog.drop_nan" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">drop_nan</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Drop rows with NaN values in specified columns or validated columns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code>list or None, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names to check for NaN. 
If None, uses all validated columns.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inplace</code>
            </td>
            <td>
                  <code>bool, default=False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, performs operation in-place and returns None.
If False, returns a copy of the data with rows dropped.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>how</code>
            </td>
            <td>
                  <code>str, default=&#39;any&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How to drop nan values. Options are:
'any' : Drop if any of the specified columns has NaN
'all' : Drop only if all of the specified columns have NaN</p>
              </div>
            </td>
            <td>
                  <code>&#39;any&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame or None: The DataFrame with NaN rows dropped, or None if inplace=True.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.split_data" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">split_data</span>


<a href="#agnboost.dataset.Catalog.split_data" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">split_data</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">val_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stratify_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Split the data into train, validation, and test sets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>test_size</code>
            </td>
            <td>
                  <code>float, default=0.2</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Proportion of the data to use for testing (0.0 to 1.0).</p>
              </div>
            </td>
            <td>
                  <code>0.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val_size</code>
            </td>
            <td>
                  <code>float, default=0.2</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Proportion of the data to use for validation (0.0 to 1.0).</p>
              </div>
            </td>
            <td>
                  <code>0.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code>int or None, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducibility.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stratify_col</code>
            </td>
            <td>
                  <code>str or None, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name to use for stratified splitting. 
If provided, ensures proportional representation of this column's values
in all splits. For continuous columns, binning will be applied.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_bins</code>
            </td>
            <td>
                  <code>int, default=10</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bins to use when stratifying on a continuous column.
Only used when stratify_col is a continuous variable.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(train_indices, val_indices, test_indices) - Indices for each split</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.dataset.Catalog.get_split_df" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_split_df</span>


<a href="#agnboost.dataset.Catalog.get_split_df" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_split_df</span><span class="p">(</span><span class="n">split_type</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">include_features</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_DMatrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a dataframe for the specified data split.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>split_type</code>
            </td>
            <td>
                  <code>str, default=&#39;train&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which data split to use. Options: 'train', 'val'/'validation', or 'test'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;train&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_features</code>
            </td>
            <td>
                  <code>bool, default=True</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, include the feature columns in the result.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_target</code>
            </td>
            <td>
                  <code>str, list, or None, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target column(s) to include. 
If None, no target columns are included.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_DMatrix</code>
            </td>
            <td>
                  <code>bool, default = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return a XGBoost DMatrix instead of a pandas Dataframe.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>missing</code>
            </td>
            <td>
                  <code>int, float, or None, default=np.nan</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to represent missing values in XGBoost.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.nan">nan</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: DataFrame for the specified split with requested columns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="agnboost-class">AGNBoost Class<a class="headerlink" href="#agnboost-class" title="Permanent link">&para;</a></h2>
<p>The <code>AGNBoost</code> class provides the machine learning functionality, including model training, hyperparameter tuning, and prediction with uncertainty quantification.</p>
<h3 id="key-features_1">Key Features<a class="headerlink" href="#key-features_1" title="Permanent link">&para;</a></h3>
<ul>
<li>XGBoostLSS integration for distributional modeling</li>
<li>Hyperparameter optimization</li>
<li>Model persistence and loading</li>
<li>Multi-target support</li>
<li>Comprehensive logging and validation</li>
</ul>


<div class="doc doc-object doc-class">




    <div class="doc doc-contents first">


        <p>A machine learning framework for simultaneous AGN identification and photometric redshift estimation.</p>
<p>AGNBoost utilizes the XGBoostLSS algorithm to predict both the fraction of mid-IR 
3-30 μm emission attributable to an AGN power law (fracAGN) and photometric redshift 
from JWST NIRCam and MIRI photometry. The framework analyzes 121 input features 
derived from multi-band infrared observations, including original magnitudes, color 
indices, and their squared values to enhance AGN discrimination. The computational 
efficiency and scalability make AGNBoost well-suited for large-scale JWST surveys 
requiring rapid AGN identification and redshift estimation.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.model.AGNBoost.models_dir">models_dir</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory path for storing/loading trained models.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.model.AGNBoost.models">models</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing trained XGBoostLSS models for each target variable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.model.AGNBoost.model_info">model_info</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary storing metadata and performance information for each model.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.model.AGNBoost.feature_names">feature_names</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature (column) names used for model input.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.model.AGNBoost.target_variables">target_variables</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping target variable names to their probability distributions.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.model.AGNBoost.logger">logger</span></code></td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger instance for this AGNBoost object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="agnboost.model.AGNBoost.ALLOWED_DISTS">ALLOWED_DISTS</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Class-level list of allowed probability distributions ['ZABeta', 'Beta'].</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic usage with default settings:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">agnboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">AGNBoost</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># Initialize with defaults</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">agnboost</span> <span class="o">=</span> <span class="n">AGNBoost</span><span class="p">()</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># Train models (assuming you have training data)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">agnboost</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1"># Make predictions</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">agnboost</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</span></code></pre></div>
<p>Initialize with custom target variables:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">targets</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fagn&#39;</span><span class="p">:</span> <span class="s1">&#39;ZABeta&#39;</span><span class="p">,</span> <span class="s1">&#39;redshift&#39;</span><span class="p">:</span> <span class="s1">&#39;Beta&#39;</span><span class="p">}</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">agnboost</span> <span class="o">=</span> <span class="n">AGNBoost</span><span class="p">(</span><span class="n">target_variables</span><span class="o">=</span><span class="n">targets</span><span class="p">)</span>
</span></code></pre></div>
<p>Initialize with custom features:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;F115W&#39;</span><span class="p">,</span> <span class="s1">&#39;F150W&#39;</span><span class="p">,</span> <span class="s1">&#39;F200W&#39;</span><span class="p">,</span> <span class="s1">&#39;F277W&#39;</span><span class="p">,</span> <span class="s1">&#39;F770W&#39;</span><span class="p">,</span> <span class="s1">&#39;F1000W&#39;</span><span class="p">,</span> <span class="s1">&#39;F1130W&#39;</span><span class="p">]</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">agnboost</span> <span class="o">=</span> <span class="n">AGNBoost</span><span class="p">(</span><span class="n">feature_names</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>
</span></code></pre></div>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.get_models" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_models</span>


<a href="#agnboost.model.AGNBoost.get_models" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_models</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the feature dataframe, creating it if it doesn't exist.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing all models.
Model values will be None if a model has not been loaded or trained.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.tune_model" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">tune_model</span>


<a href="#agnboost.model.AGNBoost.tune_model" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">tune_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">dtune</span><span class="p">,</span> <span class="n">split_type</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">max_minutes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nfold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Tune hyperparameters for the specified model with Optuna.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the model to tune. 
Must be in self.model_names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param_grid</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of hyperparameter ranges to search.
Example: 
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>param_grid = {
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    &#39;max_depth&#39;: [&quot;int&quot;, {&quot;low&quot;: 1,      &quot;high&quot;: 10,    &quot;log&quot;: False}], 
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    &#39;eta&#39;: [&quot;float&quot;, {&quot;low&quot;: 1e-5,   &quot;high&quot;: 1,     &quot;log&quot;: True}]
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>}
</span></code></pre></div></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtune</code>
            </td>
            <td>
                  <code><span title="xgboost.DMatrix">DMatrix</span> or <span title="agnboost.utils.pd.DataFrame">DataFrame</span> or <span title="agnboost.dataset.Catalog">Catalog</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data to use for tuning. 
If DataFrame or Catalog, will be converted to DMatrix.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_minutes</code>
            </td>
            <td>
                  <code>int, default=10</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum duration for tuning in minutes.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nfold</code>
            </td>
            <td>
                  <code>int, default=2</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of cross-validation folds.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>early_stopping_rounds</code>
            </td>
            <td>
                  <code>int, default=100</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rounds without improvement before early stopping.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict or None: Dictionary containing best parameters and tuning metrics. 
Returns None if error is encountered.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.retrieve_dist" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">retrieve_dist</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#agnboost.model.AGNBoost.retrieve_dist" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">retrieve_dist</span><span class="p">(</span><span class="n">dist_name</span><span class="p">,</span> <span class="n">response_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieve a configured XGBoostLSS model.</p>
<p>Creates and returns an XGBoostLSS object with the specified probability distribution
and configuration parameters. </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dist_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the probability distribution to use. Must be one of
the values in ALLOWED_DISTS ['ZABeta', 'Beta'].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>response_fn</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Response function for the distribution parameters.
Common options include 'exp', 'softplus'. If None and params is provided,
uses value from params. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stab</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stabilization method for gradients and Hessians to improve
model convergence. Options include 'None', 'L2', 'MAD'. If None and params
is provided, uses value from params. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loss function to use for training. Typically 'nll' 
(negative log-likelihood). If None and params is provided, uses value from
params. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing distribution parameters. If provided,
overrides individual parameter arguments. Expected keys: 'stabilization',
'response_fn', 'loss_fn'. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>XGBoostLSS</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configured XGBoostLSS model with the specified distribution, or None
if an error occurs during object creation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there's an error creating the XGBoostLSS object, logs the error
and returns None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Create a ZABeta distribution with default parameters:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">dist_obj</span> <span class="o">=</span> <span class="n">AGNBoost</span><span class="o">.</span><span class="n">retrieve_dist</span><span class="p">(</span><span class="s2">&quot;ZABeta&quot;</span><span class="p">)</span>
</span></code></pre></div></p>
<p>Create a Beta distribution with custom parameters:
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">dist_obj</span> <span class="o">=</span> <span class="n">AGNBoost</span><span class="o">.</span><span class="n">retrieve_dist</span><span class="p">(</span><span class="s2">&quot;Beta&quot;</span><span class="p">,</span> <span class="n">response_fn</span><span class="o">=</span><span class="s2">&quot;softplus&quot;</span><span class="p">,</span> <span class="n">stab</span><span class="o">=</span><span class="s2">&quot;L2&quot;</span><span class="p">)</span>
</span></code></pre></div></p>
<p>Create using a parameters dictionary:
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;response_fn&#39;</span><span class="p">:</span> <span class="s1">&#39;softplus&#39;</span><span class="p">,</span> <span class="s1">&#39;stabilization&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;loss_fn&#39;</span><span class="p">:</span> <span class="s1">&#39;nll&#39;</span><span class="p">}</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">dist_obj</span> <span class="o">=</span> <span class="n">AGNBoost</span><span class="o">.</span><span class="n">retrieve_dist</span><span class="p">(</span><span class="s2">&quot;ZABeta&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</span></code></pre></div></p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.custom_objective" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">custom_objective</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#agnboost.model.AGNBoost.custom_objective" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">custom_objective</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">hp_dict</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">d_train</span><span class="p">,</span> <span class="n">nfold</span><span class="p">,</span> <span class="n">num_boost_round</span><span class="p">,</span> <span class="n">early_stopping_rounds</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Custom objective function for Optuna hyperparameter optimization.</p>
<p>Defines the optimization objective for tuning hyperparameters using Optuna.
The function constructs hyperparameter combinations based on the provided search space,
trains models using cross-validation, and returns the validation loss for optimization.
Supports automatic pruning of unpromising trials and handles various parameter types
including categorical, float, and integer parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trial</code>
            </td>
            <td>
                  <code><span title="optuna.Trial">Trial</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optuna trial object used for suggesting hyperparameter values
and managing the optimization process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hp_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary defining the hyperparameter search space. Each key is a
parameter name, and values are tuples of (param_type, param_constraints) where
param_type is one of ['categorical', 'float', 'int', 'none'] and param_constraints
define the search range or options.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the probability distribution to use. Must be one of the values
in ALLOWED_DISTS ['ZABeta', 'Beta'].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d_train</code>
            </td>
            <td>
                  <code><span title="xgboost.DMatrix">DMatrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training data in XGBoost DMatrix format for cross-validation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nfold</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds for cross-validation during hyperparameter optimization.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_boost_round</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of boosting rounds to train.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>early_stopping_rounds</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rounds with no improvement after which training
will be stopped early.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducible results across trials.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum cross-validation test score (loss) achieved by the model with
the suggested hyperparameters. Lower values indicate better performance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The function automatically handles special XGBoostLSS parameters ('stabilization',
'response_fn', 'loss_fn') separately from standard XGBoost parameters to avoid
warnings during model training. It also implements Optuna's XGBoost pruning callback
to terminate unpromising trials early, improving optimization efficiency.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.custom_tune_function" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">custom_tune_function</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#agnboost.model.AGNBoost.custom_tune_function" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">custom_tune_function</span><span class="p">(</span><span class="n">hp_dict</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">dtrain</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_minutes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_boost_round</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">nfold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Perform hyperparameter optimization for AGNBoost models using Optuna. This offers the same 
functionality of XGBoostLSS's built-in hyperparameter tuning, but also allows the tuning of 
distributional parameters.</p>
<p>Automatically selects the optimal hyperparameter tuning strategy based on the search
space characteristics. Uses grid search for purely categorical parameters and Bayesian
optimization (TPE) for mixed or continuous parameter spaces. Implements pruning to
terminate unpromising trials early and provides comprehensive optimization results.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hp_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary defining the hyperparameter search space. Each key is a
parameter name, and values are tuples of (param_type, param_constraints) where
param_type is one of ['categorical', 'float', 'int', 'none'].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the probability distribution to use. Must be one of the values
in ALLOWED_DISTS ['ZABeta', 'Beta'].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtrain</code>
            </td>
            <td>
                  <code><span title="xgboost.DMatrix">DMatrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training data in XGBoost DMatrix format for cross-validation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_trials</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of optimization trials to run. If None and
all parameters are categorical, uses grid search to try all combinations.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_minutes</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum time limit for optimization in minutes. 
Optimization will stop after this duration regardless of n_trials.
Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_boost_round</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of boosting rounds for each trial.
Defaults to 500.</p>
              </div>
            </td>
            <td>
                  <code>500</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nfold</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds for cross-validation during optimization.
Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>early_stopping_rounds</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rounds with no improvement after
which training will be stopped early. Defaults to 20.</p>
              </div>
            </td>
            <td>
                  <code>20</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducible optimization results.
Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metrics</code>
            </td>
            <td>
                  <code><span title="optional">optional</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional metrics to track during optimization. Currently unused.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optuna.Study: Completed Optuna study object containing optimization results,
including best parameters, trial history, and performance metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The function automatically determines the optimization strategy: if all parameters
are categorical, it uses grid search to exhaustively try all combinations. Otherwise,
it uses Tree-structured Parzen Estimator (TPE) for Bayesian optimization. Median
pruning is applied to terminate unpromising trials early, improving efficiency.
The optimal number of boosting rounds is automatically determined and included
in the returned results.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.plot_eval" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">plot_eval</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#agnboost.model.AGNBoost.plot_eval" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">plot_eval</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="n">best_iter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot the training and validation loss curves.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of model evaluations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>Catalog instance</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Catalog object used for training.
Used to scale the training/validation curves according to the training/validation sizes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib.pyplot.axis: The figure axis.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.train_model" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">train_model</span>


<a href="#agnboost.model.AGNBoost.train_model" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">train_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">dtrain</span><span class="p">,</span> <span class="n">dval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_type</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">num_boost_round</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose_eval</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">custom_objective</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Train an AGNBoost model with the given parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the model to train. 
Must be in self.model_names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtrain</code>
            </td>
            <td>
                  <code><span title="xgboost.DMatrix">DMatrix</span> or <span title="agnboost.dataset.Catalog">Catalog</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training data. 
If a Catalog, will create a DMatrix using the specified split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dval</code>
            </td>
            <td>
                  <code>xgboost.DMatrix, bool, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Validation data. 
If a DMatrix, use directly.
If True and dtrain is a Catalog, create a validation DMatrix from the Catalog.
If False or None, no validation data is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code>dict, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of model hyperparameters to use
If None, uses saved tuned_params from model_info if available,
otherwise uses default parameters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>split_type</code>
            </td>
            <td>
                  <code>str, default=&#39;train&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which data split to use if dtrain is a Catalog. 
Options: 'train', 'val', 'test'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;train&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_boost_round</code>
            </td>
            <td>
                  <code>int, default=1000</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of boosting rounds.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>early_stopping_rounds</code>
            </td>
            <td>
                  <code>int or None, default=50</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rounds without improvement before early stopping.
If None, no early stopping is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose_eval</code>
            </td>
            <td>
                  <code>int or bool, default=100</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Controls XGBoost's logging frequency. 
If True, prints every round.
If int, prints every verbose_eval rounds. 
If False, no logging.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>custom_objective</code>
            </td>
            <td>
                  <code>callable, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom objective function for XGBoost.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>custom_metric</code>
            </td>
            <td>
                  <code>callable, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom evaluation metric for XGBoost.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(trained_model, training_results)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.get_available_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_available_files</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#agnboost.model.AGNBoost.get_available_files" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_available_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get all available files in the provided path.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the directory to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list or None: list of file paths, or None if the path does not exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.get_available_models" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_available_models</span>


<a href="#agnboost.model.AGNBoost.get_available_models" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_available_models</span><span class="p">(</span><span class="n">target_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get all available models. Will either get all available models for the provided target,
or will return a list of the avilable model types (e.g., fracAGN, redshift, etc.).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target_name</code>
            </td>
            <td>
                  <code>str, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of model type to check.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the directory for the passed target does not yet exist. </p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of available models or model types.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.load_model" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_model</span>


<a href="#agnboost.model.AGNBoost.load_model" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a pre-trained model and its metadata from into the AGNBoost instance.</p>
<p>Deserializes a previously saved XGBoostLSS model from pickle or gzip format and
restores it to the AGNBoost instance. Performs comprehensive validation including
feature compatibility checks, model data structure verification, and metadata
restoration. Supports automatic selection of the most recent model file if no
specific filename is provided.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the target variable model to load. Must correspond
to a valid model type (e.g., 'fagn', 'z_transformed').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific filename of the model to load. If None,
automatically selects the most recently modified file in the model
subdirectory. Can include or omit the '.pkl' extension. Supports both
'.pkl' and '.gz' formats. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overwrite an already loaded model
in the AGNBoost instance. If False and a model is already loaded,
the operation will fail. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the model was loaded successfully, False if an error occurred
during loading, validation, or if overwrite constraints were violated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the model subdirectory doesn't exist or no model files
are found in the expected directory.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pickle.UnpicklingError">UnpicklingError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file is corrupted or not a valid pickle file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For other unexpected errors during the loading process.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Load the most recent model file automatically:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Loads the most recently modified model file for &#39;fagn&#39;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">success</span> <span class="o">=</span> <span class="n">agnboost</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;fagn&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p>Load a specific model file:
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Load a specific model file</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">success</span> <span class="o">=</span> <span class="n">agnboost</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;z_transformed&#39;</span><span class="p">,</span> <span class="s1">&#39;my_redshift_model.pkl&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p>Load with filename without extension:
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># The .pkl extension is automatically added</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">success</span> <span class="o">=</span> <span class="n">agnboost</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;fagn&#39;</span><span class="p">,</span> <span class="s1">&#39;final_agn_model&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p>Overwrite an existing loaded model:
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Replace currently loaded model with a different one</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">success</span> <span class="o">=</span> <span class="n">agnboost</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;fagn&#39;</span><span class="p">,</span> <span class="s1">&#39;newer_model.pkl&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div></p>
<p>Load a compressed model:
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Automatically handles gzip compressed files</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">success</span> <span class="o">=</span> <span class="n">agnboost</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;z_transformed&#39;</span><span class="p">,</span> <span class="s1">&#39;compressed_model.pkl.gz&#39;</span><span class="p">)</span>
</span></code></pre></div></p>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The method performs several validation steps:
- Verifies input parameter types and values
- Checks model subdirectory existence<br />
- Validates loaded model data structure
- Compares feature compatibility between saved and current models
- Ensures model names match expected targets</p>
<p>Feature compatibility is strictly enforced - the loaded model must have been
trained with identical features to the current AGNBoost instance. Any mismatch
will result in loading failure with detailed logging of differences.</p>
<p>The method supports both pickle (.pkl) and gzip-compressed (.pkl.gz) formats
automatically based on file extension. Model metadata including training
parameters, performance metrics, and timestamps are restored along with the
model object.</p>
<p>If no specific filename is provided, the method automatically selects the
most recently modified file in the model subdirectory, making it easy to
load the latest trained model.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.dmatrix_validate" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">dmatrix_validate</span>


<a href="#agnboost.model.AGNBoost.dmatrix_validate" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">dmatrix_validate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">split_use</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate and convert input data to XGBoost DMatrix format.</p>
<p>Handles multiple input data formats and converts them to the standardized DMatrix
format required by XGBoost models. Supports Catalog objects with optional
data split selection, and validates existing DMatrix objects. Performs feature
extraction and handles missing value encoding for optimal XGBoost compatibility.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="agnboost.dataset.Catalog">Catalog</span> or <span title="xgboost.DMatrix">DMatrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input data to validate and convert.
If Catalog, extracts features and optionally applies data splitting.
If DMatrix, validates and passes through unchanged.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>split_use</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific data split to use when data is a Catalog.
Common values include 'train', 'val', 'test', 'trainval'. If None and
data is a Catalog, uses the entire feature dataset. Ignored if data
is already a DMatrix. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>xgboost.DMatrix or None: Validated DMatrix object ready for XGBoost operations,
or None if validation fails or an error occurs during conversion.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.predict" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">predict</span>


<a href="#agnboost.model.AGNBoost.predict" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">predict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">split_use</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate predictions using an internal trained XGBoostLSS model for the specified target variable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>pandas.DataFrame, Catalog, or xgboost.DMatrix</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input data for prediction.
If Catalog, can optionally specify which data split to use. If DataFrame,
must contain all required features. If DMatrix, used directly for prediction.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the specific model to use for predictions. Must
correspond to a trained model in the AGNBoost instance (e.g., 'fagn', 
'z_transformed').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>split_use</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific data split to use when data is a Catalog
object. Common values include 'train', 'val', 'test', 'trainval'. Ignored
if data is not a Catalog. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducible prediction results. Ensures
consistent outputs across multiple prediction runs with identical inputs.
Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy.ndarray or None: Array of prediction expectation values for the target
variable, or None if prediction fails due to data validation errors,
model unavailability, or feature compatibility issues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Predict AGN fractions on test data:
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Using a Catalog with test split</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">fagn_predictions</span> <span class="o">=</span> <span class="n">agnboost</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">catalog</span><span class="p">,</span> <span class="s1">&#39;fagn&#39;</span><span class="p">,</span> <span class="n">split_use</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p>Predict redshifts on new data:
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Using a pandas DataFrame</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">z_predictions</span> <span class="o">=</span> <span class="n">agnboost</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_data_df</span><span class="p">,</span> <span class="s1">&#39;z_transformed&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p>Predict on validation set with custom seed:
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Reproducible predictions on validation data</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">agnboost</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">catalog</span><span class="p">,</span> <span class="s1">&#39;fagn&#39;</span><span class="p">,</span> <span class="n">split_use</span><span class="o">=</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span></code></pre></div></p>
<p>Handle prediction errors gracefully:
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">agnboost</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;fagn&#39;</span><span class="p">)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">if</span> <span class="n">predictions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span><span class="si">}</span><span class="s2"> predictions&quot;</span><span class="p">)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction failed - check data and model status&quot;</span><span class="p">)</span>
</span></code></pre></div></p>


<details class="notes" open>
  <summary>Notes</summary>
  <p><strong>Prediction Type</strong>: Returns expectation values (means) of the predicted
probability distributions rather than raw distribution parameters.</p>
<p>When using the pre-trained models:
    For AGN models, predictions typically represent fracAGN values (0-1 range).
    For redshift models, predictions represent transformed redshift values that
    may require inverse transformation to obtain physical redshift units.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.prediction_uncertainty" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prediction_uncertainty</span>


<a href="#agnboost.model.AGNBoost.prediction_uncertainty" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">prediction_uncertainty</span><span class="p">(</span><span class="n">uncertainty_type</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">split_use</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_permutation</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Estimate total predictive uncertainty  for a trained model. Will return the model uncertainty, 
uncertainty due to photometric error, or the combination of the two depending on the value of 
'uncertainty_type.' This allows for robust uncertainty quantification for AGNBoost estimates,
accounting for all types of uncertainty.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>uncertainty_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of uncertainty to estimate.
Allowed values are: 'all', 'photometric', 'model'</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>Catalog instance</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the Catalog object to take data from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the model to retrieve. Must be a key in the models
dictionary and correspond to a valid target variable (e.g., 'fagn', 
'z_transformed').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>split_use</code>
            </td>
            <td>
                  <code>str, default=None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific data split to use when data is a Catalog
object. Common values include 'train', 'val', 'test', 'trainval'. Ignored
if data is not a Catalog. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>M</code>
            </td>
            <td>
                  <code>int, default=10</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of models in the virtual ensemble. Controls the
granularity of epistemic uncertainty estimation. Higher values provide
more detailed uncertainty estimates but increase computation time.
Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code>int, default = 123</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducible uncertainty estimates.
Ensures consistent results across multiple runs with identical inputs.
Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_permutation</code>
            </td>
            <td>
                  <code>int, default=100</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of Monte Carlo iterations to run 
if calculating the uncertainty due to photometric uncertainty.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray or None: Array of total uncertainty estimates for each input sample.
For single samples, returns a scalar value. For multiple samples,
returns an array with one uncertainty value per input.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.model_uncertainty" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">model_uncertainty</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#agnboost.model.AGNBoost.model_uncertainty" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">model_uncertainty</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">DMatrix</span><span class="p">,</span> <span class="n">dist_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">best_iter</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">M</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Estimate total predictive uncertainty by decomposing epistemic and aleatoric components.</p>
<p>Implements uncertainty quantification for XGBoostLSS models using a virtual ensemble
approach based on boosting iteration truncation. Creates multiple model snapshots
at different training stages to approximate epistemic (model) uncertainty, while
extracting aleatoric (data) uncertainty from the predicted distributions. Returns
the total uncertainty as the combination of both components.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="xgboostlss.model">model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Trained XGBoostLSS model object containing the
booster, distribution, and starting values needed for prediction.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="xgb.DMatrix">DMatrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input data in XGBoost DMatrix format for which uncertainty
estimates will be computed. Can contain single or multiple samples.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the probability distribution used by the model.
Must match one of the supported distribution types (e.g., 'ZABeta', 'Beta').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>best_iter</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Best iteration number from model training, typically obtained
from early stopping or validation-based selection. Used as the reference
point for creating the virtual ensemble.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>M</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of models in the virtual ensemble. Controls the
granularity of epistemic uncertainty estimation. Higher values provide
more detailed uncertainty estimates but increase computation time.
Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducible uncertainty estimates.
Ensures consistent results across multiple runs with identical inputs.
Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="agnboost.utils.np.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: Array of total uncertainty estimates for each input sample.
For single samples, returns a scalar value. For multiple samples,
returns an array with one uncertainty value per input.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.model.AGNBoost.uncertainty_phot" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">uncertainty_phot</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#agnboost.model.AGNBoost.uncertainty_phot" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">uncertainty_phot</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="n">Catalog</span><span class="p">,</span> <span class="n">dist_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_permutation</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Estimate the prediction uncertainty due to photometric uncertainty. 
Performs monte carlo, randomly sampling the photometric bands 
(assuming a normal flux distribution) accoridng to the photometric error bands 
stored in the catalog object's data. The standard deviation of the monte carlo preditions
is taken to be the prediction uncertainty due to photometric uncertainty.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="xgboostlss.model">model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The trained model to use to make predictions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog</code>
            </td>
            <td>
                  <code>Catalog instance</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the Catalog object to take data from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the probability distribution type to make predictions with
This should correspond to the distribution stored in self.target_variables[model_name]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code>int, default = 123</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducible uncertainty estimates.
Ensures consistent results across multiple runs with identical inputs.
Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_permutation</code>
            </td>
            <td>
                  <code>int, default=100</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of Monte Carlo iterations to run 
if calculating the uncertainty due to photometric uncertainty.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="agnboost.utils.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray or None: Array of the uncertainty estimates.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="utility-functions">Utility Functions<a class="headerlink" href="#utility-functions" title="Permanent link">&para;</a></h2>
<p>Helper functions for data processing, feature engineering, and model management.</p>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="agnboost.utils.log_message" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">log_message</span>


<a href="#agnboost.utils.log_message" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">log_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Log a message with the specified level.</p>
<h5 id="agnboost.utils.log_message--parameters">Parameters:<a class="headerlink" href="#agnboost.utils.log_message--parameters" title="Permanent link">&para;</a></h5>
<p>message : str
    Message to log.
level : str
    Log level (INFO, WARNING, ERROR).</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.utils.validate_param_grid" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_param_grid</span>


<a href="#agnboost.utils.validate_param_grid" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">validate_param_grid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate that the parameter grid is correctly formatted.</p>
<p>Expected format:
{
    "param_name": ["type", type_specific_value],
    ...
}</p>
<p>Where "type" is one of:
- "none": type_specific_value should be a list of specific values
- "int": type_specific_value should be a dict with "low", "high", "log" keys
- "float": type_specific_value should be a dict with "low", "high", "log" keys
- "categorical": type_specific_value should be a list of possible values</p>
<h5 id="agnboost.utils.validate_param_grid--parameters">Parameters:<a class="headerlink" href="#agnboost.utils.validate_param_grid--parameters" title="Permanent link">&para;</a></h5>
<p>param_grid : dict
    Dictionary of parameter grid specifications</p>
<h5 id="agnboost.utils.validate_param_grid--returns">Returns:<a class="headerlink" href="#agnboost.utils.validate_param_grid--returns" title="Permanent link">&para;</a></h5>
<p>tuple
    (is_valid, error_message) - (True, None) if valid, (False, error_msg) if invalid</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agnboost.utils.validate_param_dict" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_param_dict</span>


<a href="#agnboost.utils.validate_param_dict" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">validate_param_dict</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate that the passed params are a dictionary of single values</p>
<p>Expected format:
{
    "param_name": value,
    ...
}</p>
<h5 id="agnboost.utils.validate_param_dict--parameters">Parameters:<a class="headerlink" href="#agnboost.utils.validate_param_dict--parameters" title="Permanent link">&para;</a></h5>
<p>params : dict
    Dictionary of parameter grid specifications</p>
<h5 id="agnboost.utils.validate_param_dict--returns">Returns:<a class="headerlink" href="#agnboost.utils.validate_param_dict--returns" title="Permanent link">&para;</a></h5>
<p>tuple
    (is_valid, error_message) - (True, None) if valid, (False, error_msg) if invalid</p>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.highlight", "search.share", "content.code.copy", "content.action.view"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>